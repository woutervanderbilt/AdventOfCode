using System;
using System.Threading.Tasks;

namespace Problems.Advent._2021;

internal class Dag25 : Problem
{
    private const string input =
        @"..v>.>.v..>v>.vvvvvv.>v.....>...>>..>.v>.....>..v.>..>v>..>.v.......v.vv>...v>..>..>..v.v.v..>>>v........v.v.>vv>>>...>.>>v...v>>.>.>...>..
>.>.>.v..>......v.>>vv.v>..>v>....>....vv.v....v>.vv.v.v>v>v....>v.>>v>>.>>>..v>...v.>.>vv..>>v...vvvv.......v.vvv>.v>>v...v>..>>.v>vv.>v..
>.v..>>.v>..vv...>.>..>v..v...vv>....v>v.>v..>....>v>.....>v>.v>>.v>...vv..>v>.v>>v.vv......>...v.>..>.>>vv..>...v.v.>.v...v..vv..>....>.>v
....>vv.v>v.>..>.v..v>>>v...v.v..>>...v.>......v.v.v..v>..v.>>v.>v>v.v....v>.>.>...>...vv.v.v..>>........>..>....v.>..v>...v..>...v.>>...>.
v..v...>v....>>....v.>.....>..v>....v>v.........v.>vv>>.v.>>v>>...>>.>v.vv>.v......>...vv.>>v..v>>...>.....>.>.vv.v>v>v.v.v..>...>vvvv.v...
.v.v..>v>>>vv..v..>....>>.v.v.>>vv.>>...>v..>v>..v.v.>>...v.v..>>.>>...vv.v......v...v.v...>>..>v>>>...v.vv..v...>>>v.>..v>vv.vv..v..v>>>..
v>..v.>v>.v.>..vv......v...>...>..vv>>..>.v..>vvv.v>>.>.v.v...v.>.>>.v.v.v.vv.v>>>.v.v.....v..>.vv.>>>>>>....v.>>.>v>>.v.>.>...vv.....>v..>
vv>vv..>.vv...>vv..>.....>v>>>>v.v>......v...>.v...v....v..>v...>>.v>.>vvv.v>.vvvvv>>vvv..>>....>.>>v>v..v...>v.vv.v....>>.>v.>..>v..>.>vvv
>>>v.v>..>.>.>v..v>v.vvv>...vv>>v.vv.>>vv>v>>......vvvv..>.>.>.>..>.>v>.v...>.....>vv..>.>v.>..>.>v>v.v.....vv.v.......v>..v.>..v.v..v...v.
..vv.v..>>v..vv.v>.v....>..>..v.v....v.>.v.>..>.>vvv..>>vvv>v>.>v.v.>...vv..v..>.v..v..v..>v>vv....>>.>..>vv>....>>..>...>v.v>..v...vv.>.>>
.v..>..>>>v....vv.>vvv.>.>v.v....>>v...>v..v.v>v..>.>>vv...v..v.v.v>.>v.v.v>v>vv......v..>...v..>.>....>>........v.v>>.>>....>..v>...vvv...
.>..>>...>..>.>....v>>..>>>v..v>.>>>>.>.v>....>.>.vv>v.>.v>>>v>>..v..v......v>.>>v...v>.v.>v......>v>.v.>>.v..>>...vvv.v>....v.vv>...>.vvv.
.....v..v..>v.>vv>v>>.v...vv.>v.v.>>>>..>...v>.v.>.v>.v...vv>..v.......>..vv.>v>>vvv>v..>v...>>v.>>..vv>.vv>....vvv.vv.>.vvv..>v>>.>..>v.>.
>.>>>..>.v.>..v.>...>v>...vv>....vv.v..>vv.v.vvv..>>>...vvv>.>>>.>.....>..>v...v>v..vv..>>.>..>>v...v....>>..>.>.v>>.v>v..v.>v.v.>>v.>..>>v
v.vv>.v>v.v>....v..v.v>.v>.v....>..v>>..>.v.>.>v>.>>v>>..vv..v.>v..v.v...>>.>.>>vvv>...vv>...>.vv.......>..>..v>.vv.v.vv...v..v.>>....v>.vv
v...>.>>..v.>..v.v..v.>.......>...vvv.v..>.v..>v...>v.v..v.v>.v..>>...vv....v.v....v.>v...v.v.....>v.....>vv..v.v....vv>>v..v..>v.v...v.v.v
..>>vv.v>v..>.v...v.v>..>.>.vv..v..v>vv.>v.....>v.>vv.>...v.>.>v.v>>...>>.v...>.>...v>..>>v>v>...>>..>...>v.>...>v...>..>.>vv>>.vv.v.vv>...
v..>vv>>...>.vv..>.v.v.>...>....>v.>v.>.vv..v..>...>...v.v..>.>>>.>....>>.>>vv....v.v.>v...>.......v.v...vv....>.>.v>.v>>..v...v.v..>v>>v..
v>>vvv.v....>.>vvv>v.v..vv>...v.>.>..vv>.v..vvv>v.>..v>.v>....v>>.>>>..>.>.vv.....>>>v.>.v..>v>...vvv..v.>.v...>..vv..vvv.v....>.vvv..v....
.vv>v>vv...>...>>vv.>vvv>.v...>.>....v..>....>.v>vvv....>vv.v..v>>vv...>v.>.v..>v.>.>vv...>>.v.vv......>>>vv.vv..v..vv>..>>.vv..>..v..>v.v>
>>v>.>.>v>.>>>.>>v.>v.>.v>>.>>v.>.v..>vv..>.v..>...>v>.v>v..v.v.v...>>>v.>.vvv...v>.>.v.v>..>>>>.>>v>..vv.>>>>vv.vv>v>v>v.vv.vv.>.v......>.
v.v...>v.vv>..>>.vv>....v>>.v.v.v.>.v>.>vv...v..vv...v..vvvv.>...>v.v.v>vv.vv.v.v.v.vvv>..v..>..........v.....>.v.v.v.>>>...>>.v.>>.>.v.v>v
>..>..vv.>v....>.>...v..>.>vv>>v..>.v.>>v.v..vvv>v..vv.>.>...>.>..v>v.>vv..>.>vv...v>.vv........>...v.v.>vv>>..>>.v>..v..>>>..v.v>.v...vvv.
...>>.>>.....>v..>.vvv>..v..vv.>vvvv>v.>>.....>>..>..v>.>v..v.>....v..>>..vv>.>v.v>v..v.v..vv..>>v>.v.>>.vvvvv>>.v.>v>vv.vv>>.v>>..v>..>...
.>.>.>>....>.>.>>v...>.>......v>..>>.>v...v..v..v>>>>.>.......v>.v>........vv.>v..>..v.....>>>.....vv...>...vv>>.>v>....>.>..v....>...>v>v>
>..v....v..v>v.>..>>.v>>......>>v.>.v...>v>>.>vv.v.>....v.v>.>....v...>..>.....>v>...>vv..v..vv...>..>v..>.>.>>.>>...vvvvv.>>.vv.vv..>v....
>.v.....>>v..v.v...v..>..>.>vv>>v....>>.>.>v>v>.>>>>>.>.>>v...>>....v...v>>.>>...v.>.>vv>..>.v..>.>...>vv...v.>v..v.>v...>v>...>.>.v>v>>>>v
v.....v.>vv...v.>..>vv.vv>...vv>..>>vvv..v>>v>v..v.v.>.>vv.....v>vv...>vvv..>>v>...>..>>v..vv.v>v...v.v..>v.v>v>>..>.....>v.v>v.....>>>>...
>v>v.>.v.>>v.........v.........v.>v.v>.>...>v>...>...>>v..v>v>vv..>>..v.>>>.v.>...>v>>.>...>v...>....>vvv>..vv.....vv.v>v...>.v....v......>
.v.>>>>v>v>.>>...v..vv.>.vv..v.>..>v....v..>vvv.v>>.>>v.v.v.v>v.vv..vvv...v..>>v.>v>>..vv>.>v...>>.>>v....v>.v.v>vvvv.v....>>.v>>.>.v>v.vv>
v...vv..v>vv>>..vv....>v..>>..v>.v.>v.v.v.>.>v...>>>......v.>.>.>v.>..v.>vv>v...v.....v......>..v...>v..>v.v...v.>v.vvv..>.>.>.v>vvv.>.v...
v>...vvv.>v>v>>v>v.v..v....v>v..v>v.>v.>>>>>v..>vvvv.vv...vv.>vvv....>>>...>vvv.v.>v>.v..>..>>v.v.vvvv>...>v.>......vv>....>.vv...vv.vv...>
v..>..>....>..vv..>>v.v.v.v.>v>v>....v..v>.v.>>..>vv..v...v>..>...v>>..>.>.>.>..>>vvv>>..>.>v..>..>v.>..v..>.vvvv>v>v..v>.v.>v..vvv.v>.>v>v
.>>>>...>.>.v...v>>>vv.>...v.v..>........>>v>.v>..>.vv>>vv>.vv.v.>v>vvv..>vvv...v>>...>vv.>>>.>vv.vv..v..>>..>vv>..v>.>>.>>v.v>v>..v..v..>.
.vv..v.>.>.vv.>v.vv.>.>>.v...>>...v.>vvv.v.....>>v.>.>...v>v.>>....>.v..>>...>v.>v>.>v.>.v.>>.......>.v.v>>>vvv>.>>>.v>.>>.>.v.v>v...>vv.>>
..>.>..>v..v>v.>>v..>v>.>v.>.vv.vv>.v.v>vv>.>.vvv.>...>v....v.>.v>...>.>.>...>>>....>v>>.>.v>.>v.....>>v>...>vvv..>>v.>v.vvvvv.>.vv..v..v..
>.v..v.v.v...v>....v....>>vv..v>.v.>>>v.>v....>..v......>>.v.>>v>..vv...>..>v....v..>.........>..v.....v..v>>>.v>.>v..v.>vv.>vvv>..>v.v>...
.v>>.v.>v....>..>...v.v>>v>v...vv.>v.>>..>......>v.v.>>vv>v..>..>v.v..>..>.v..>.v>.>...>v>>v.v.....>>v..v..>v>.v...v..v.v..vv>v>vv.>>.>..>>
...>>.v.v>>v.vv.v>>.v.>.>>v>.>..v>...>>>..>......>v.>v>v>....v>v>..>..v..>v>.vv>>..v...>...>>vv>v.vv.v.v.>...v.>vv..>v>.>.v>>..vv>vv.>>..v>
>..>..>vv..>....v..v.>v....>...>>>.>v..>.>.>>>.>v.v>.v..vv>.v.>...>..>v>v....v.v>.>>.>.v....v>..v.....>>v.v>...v>.v.>.>.>.vvv.>...v.vv.>.>v
v>.v>v....>v..vv>..>vv.>>.v.>>>v>.>v>.......>.v..>v..>...vvv>..v>..>.v...v>v.vvv.>..>>>v...vv.>...>>.v>>>..v.v.v...>..>...>>...>v...>...>v.
.>.>..>>>v...v>>..>v..>..>v.v>v.>.v>>...v.vv>>vv>....>>>.>.vvv>..v.>..v>>.v>.>v.>v.v.>>..v.v>...v..v>>v>vvv.>vv..>v....v..>...v.>.vvv>.>>.v
vv.vv>v..vv>>>.v....>.>>.>.>v..v>vvv..vv.v>.v.>>.v..v>...>..vv>.v..vv>v.>vvvv...v>.vv...v..vv.>>v>.>>>>.v.>>>>>>v>....vv....>....v....v.v>.
v....>>>>v.v.v..v.v>>..>>>vvvv>>.v...v>....>>...>>.>v..>>v.>......vv.vvv.>vv>.>....v.v>..>v..vv..>vv>v.>v>.>>>....>>..v....>.>.>v.>.v>v>.v.
..v...>v>vv>vv..>.v.>..v.v>v...>..>.vvv>.>..>....>>>>>>.vv..v>v.>.vvvv...v>>>>>.>......>>.vvv..v.vv.>vv>....v.>>.....>v..>>....>>v.v..>vv..
...v..v.>v...>>....>>...vvv.>.vv.>..vvv.>..>.>v...>v....>..v....>.>>vv>v....v>v>.vv.>v>v.v>>>v...v.v>>v>v....vvvvv.....v......v>v...v>>.vv.
v.>.>>>.>..vv>>vvv.....>....>vvv...vvv.v.vv>v.v>.v..v......v..>.v>..vvv.....v.v...v.>..>.>>.>>vvv>.v....>vv..>>>.>>....>.>..>...>.v.vv>>>.>
>vv.....v>v>>vv.vv..>.vv>....v.>>....>>>v>.>.v..v>.v>>.>..>>..v...>vv..vv>...>.......>>.>>.v.vv......vv>.>>vv>v.vv..>>.v..v..v..v>.....v>>v
vvv>v>v.>v.>..>.>v>>...>..>>..>.>.>..v.>.v>....>..v>.v.>.v>..vv.>>>...v..>v>>.v.>.v.>....>..v.>.>>vvv.vvv....v..v..v.>...v>>...>.>.>>>v..vv
vv>>v>.>.v.v.v>>..v..v....>>>.v..>v..v..>..>>.v.>v>v>v..v...v.v..v..>vvv>v>>v.>v...>v.v.>.>.>.v...>.v.v..vv..>v..>..v..>vv>...>v>>...v..>.v
>v...v>.>......v>>>v..v.>>v..>..vv.v.v..>...v>.......v...>.>>.>>>.>>v>vv....v....vv..v..>.vv.>>....vv..v>>.v.>.v.>.>.>.>v>.>v.>v.v....>v>>v
vv>v.v.v>.>.v>..v>vv...>..>>.vv>.v....v>>>>..v.>>.>>>.>..v>>>.v..........v.v..>.>.vv.>..>.>>v...vvv.....v....vv>>....vvv.vv....>.>.v.......
..>vv..>........v.>v........>..v......>>.>v.>v.....>>.>v>.v.>.>.v.v...>.>vv>...>..>v....>....>..>v..>v..v..>..v.>..>....v>v.>v..>.v.>>.>>..
.....>>..>>.>...v>..v.v>.v.>>>v>..>.v.vvv.>>.v..>>vv>..>.v.vv.>...vv.v..v.....vv..>..v..>.>>v.vv.>.>vv>>..>>....v>.v>v>v>>v..v.vv.>.vv>>v..
....>.v>v.>>.>.>>.....v.>v.v..v>>>>>.>.v>..v.>.vvv.v.v>.>>>>v.v..>>vv>...>v..v.....>.>....>......>.>v.v....v..>v...vv..v.v.v.>...v>>.>v>v>.
.vvv...>..v>>>>>....>>...v.v.v.v>.vv.>......v>.>.vv..>..vv........>>.>>v.v.>.>.>.>>>.>.v..vv.>.>....>.v.vv....>>....>..>.v.>..v>>v...vv>...
>>.vv..>v.>v.vv>...>.>v.>>v>.>.>v.v..v..v.v.......v>.vv.>v..>.v>.>.......>>>vv>..vvv..>>........>.>v..>....v.>..vvv.>.v..>.v..>..v>>....>.v
..>....>..vvv....>....v.v.>..>>v>..>>>v..>...>...>..>.....v>..>>>v.>>>v.>v..v...vv>.....v.v..>..vv.>..vv>>.vv......v.>..v>.....>.>v>...>vv.
.>.>..v.>v>>>>.>.....v.v...v...vv..v....v>..>.v>.v..>.>>v.v.v.>.>vv..>v..>vv.>.vv...>>>v.>.>.v......v...>...>........v......>>>>v..v....v..
vv.....v.v>..v.>.vv.v....>>.>>..v.>...>..v....>....>.....vv...v>vvv..>.vv.vv>v...v>....>>vv...v>>vv..v.v.v>.......v>.>>v.>>....v>v>.v>>.v..
..>>>..>..v>>.>>>...v>v......v.>.v>.......>v>...>.>v.....v.>>.....>>v....v.>..>vv>.>v>.v>..v>.v>....v>>.v>v.v.....v.v.....>>>>>vv..v.>v..>.
.>...vv>.v>.vv..v>.v...>v>..>>vvv.>>.>..>.>>.......>...v.v>.>.v>vv..>...>.v..>...>v.v.v...vv...v.....v>>v>v..v>.>.vv..>.vv...>v>>>>>.>>.v>.
.>.v..v>v.vv.v>v..>>.v>>v.vv.v.v..>......v..>..>>.>..>v.>.......v....v..>vvvvv.vv..>..>>.v>v>.>>...>.v.v>>v..>..>.vv>v..>...>>.>>>v>>...>.>
>>..>vvv>v..v>...>..v..>.>..v>>v.v>>..v.v.......>.....>>...>vvv.v.>>..>v.v.vv.v.v>>....v>v.v..>>vv..vv.>v....>>v>v>>.v.v.v..>...>...v.....>
.>..v.>v.v.>vv>vvv...>..v.v.>.v..>v>>>>>..v>>...>.v>.vv.....v.....>..>v.>...v....>..>v....vv.>>.v......v..>.vvvv.>.>...>....>.>...v.v...>v.
.>>>..>v.>.>.>..v.v.v.v..v.>.>.v.vv..>...>>v.>.>v.>>...v..v>>v..>..>.>.....v.vv...v.v>...v..>.....v.v..v>v....>..>..>v...v.>...>>.v.>....v>
..>>..vv>v>.......>vv..v>v..>.>v......v>..v..>...>v>.v>.v..vv...v.v.v>.>..>.....>>.vv.v>....>v.v.>>>>.v.vv>.v>.>..v>>.vv>.vvv.v....v.>...v.
>>.v>...>>>.>.v...v...>>.v>>.....v>..v>.v..>.v>v>v..>v.v>.....v>..>.>>..v.>.>>..>v>v>>>v.vvv>....v..>.>>v.vv.>.v>.>.>>.........>>.v...v>..>
..v>.vv..v.vv.>>v..v.vv..vvvv.v>.v>>.>.>>vv.>.>>>....>.>....>>>..v>v.vvvv>>v..>v..........v>..v.>...v....v>>v>..v..>..>..>>>>>...v....>v...
.>>>.v>.>>.v...v.>.....v>>v.vv....v>>....vv.v.>....>.v.>...v.v..>>vv>.>..>v.......>..v>.v.....>...>.v.v..>..>.>..>>v>.v>>>.>..>>.....>v>..v
....>.>vv>vv>..>....v..>.v...>....v..v>>.v..v.>.>.>>>..v...>.>.>>.v.......vv..>....>>>.>vv.v.>>.vv..>v>...>.>>.v>.vvv>..vv.>.>>v>>..>.>>...
..vvvv...vv..v.....v.>vv.>v.....vv...v>....>.v.v....v..>v>>..v..vv..v>v>.v.>>vv>.v..vv.v.v>>.v>vv>..>..vvv>v.>.v>..>.>....v>.>>...v.>.>...v
v.>>>>>>>v>..>vv.v.v.>.>v..>>.>v>>>v.v.....v.v.v>v>v....>.>.v..vv>.vv.v>..v>.>v>>.v.v..vv.>>>v>.>.v.v>..v....v...v>....>...v..v>v....v..>>.
>vv.>>....>v>v.v..v..>v>..>..>>v>>.v......v>.v..>.vv..v...v>....v.v.>vv....v.>>.vv..>>.v>>v..v>...>....>v....>.v...v.v.......>.>..>..v.v>..
v>>>.v>>v.vv.v......>.....v>v>v>.....>vv....v>.v.v..v>>.>>.v.>>v>>.>v.>..>.v.v...v.>>v>>...vv.....v>..vv..v.v.>>.>.v>.>.vv>v....v.>...>vv>v
v>vvvv.vv>>vv>..>.vvvv>>.v..>.v..>..v.>..v>..>.v>..>...vvv>v.>v..vv.>.>>>v....v>>>..v.v...>......v..>>v.vv>>>v..>.v..>....>v..v.>>vv>...v..
v>.v.vv.vvv.v..>>v.vv.....>...v....>..v..>.....>v..>....v.>.>>v>....>>>v>>.v>..v...>.v.>>...>>...v>.>.vv......>>.....>v>>...vvvvvv.v...>.v.
>...>.......vvv.v>v..v.....>>v>.v.>>v>.v.>>..v>vv..vv>.>.v.>.v.v>v>.v.>>.v.>...vvv..v.v.v>.v....>v>..>...v.>.>v>...>...>..vv...>....>>.v.vv
.v.v...v.>v>v....v>.>.>.>.v.v.v...vvv..v>>vv..>v.>>>v.>.>v..>v....v.>vv..>>>.....v....v..vv..v>..v...v..>..>..v>v>v>.>.vvv.v>..>..v......>v
v>>>..v.>..v....v..v>vvv>..vvv>>....v.>..v.>v...>v.v>>...vv..v..>v..vv..vv>v.v.>v.v.>>...v.vv>..>>..>>>...vvv>..>.>...v.v.>.....vvvv..>.v>>
.vv>.vvvv.....vvv>v...>..>.>.v.v>.v>>...>..v>..vv.>..>..>.>..>>vv.>v>.>v...vv>>..>>.>.v.>...v..v>...>.>>v>>..vv.vv..>v.v.>>.vv.vv..>.>>>.>v
>.>v.>>..>vv>..>..v..>>>>.>.>>..v...v.v...v..vv.>...>>>...>>>v.>>v.vv..v.v>v>.>>.v>v...vvv.v..v..>v..v.>>....>..v.v.>v>>..vv.v.>...v..v>..v
.>>>..v.v..v.>.>..vvv.v>v...v>.>......>v...v.>..>v....v....vv....v.v..vv...v>v.>v>..vv..v.v.>v.....v....>.>v..>>>>...v.....>.v>..vv>>>..v.>
....>..>vv..v..>..v>>..v>.>v.v>..>>..>.v..v>>vv.v.>>..>..v..v.v.>.>..>....>.>.v>v..v..>..>vvv>...vv..>vv>..v..>vv..>.v.>......v>...vv..v>v.
..>vv>.>.....v.v.v>v.v..>.vv..>v>v>...v>v.>.vvv.>>v...>....>>>>vv.>.v..v.>v>>.>..v>v>>>vvvv>...>v.>..vvvv...v>>v...v.v.>>.>..v>v..vv..>v>v.
.>>.>v...>.v...v>>>..>>...>...>..v..v>.>....>>.v>>v.>.v>.v.v>v.>..v.v..vvv>.>v..>vvvvv.>.>.>>v>v.v>v>v.>...vv......v>vv..>..>>v.>.v.>>...>.
.vv.>>>.v..>>.vv.v....>>vv>v.v...v..v>...v.>v.v..>v.>.v>.v.v.>..>>...>v.v>...v.>>>.v...v>>v>..v..>>...v>v.>vvv.>v...v>v.>v...v......>.>.>..
vvv...>...>...>>>>v>>.v>.>..v..v..>v>>..>>..v..>.vv>.vvv..>vv.v...vv...>.>.v..>..v>.v>v.>....>...vv>..v.v.v...>vvv.....v.>.v>v..v...>vv..>>
.v.>..v..v.v.v>..>..v..>>..vv>>.v..>>v..>.v..v>v>>v>>....>.>v.v>v>>....v>v.v.>....v>.>....v.v......>vv>vvv.v..v..>..>>.....>..>>v......v>>.
..>>.>.v....v>vv..>v..>>v.>>vv...>>.v>>..vvv>>....>>.....>.v>....v>v.>v...>.>.>..>.>v>.>v>vvv...vv>>...vv..>..v...>..>....vv.>.v...vv....v.
...>v.>....>......>.v>...>.>>v>..v..v..>..v...vv.>.v..>..v.>v.v>>>.v.>.>>.v>>......>.>.v.>v....>>v.>vv.vv.....vvv>v>v..>..>..vv>..>....v.vv
..>vv.v.v.>.v>.>..>v...>v>.>.>v>...>>....>>v.>v..v.>.>>....>>.>.>v.>.v>..v>>.>>.v.>.>v>>.>v.v..>>..v.vv...vv.>>v>.>.v>.......>.>.....>.>..>
...>.>v>........>..>..v.vv..>..>..>..v.vvv.>..v.....v....v.>.>...v.v........>.>....>>v..v..>....>vv.>...v....v.v..>.....v>v....v...v.>>...>
..v.>v...>.v.>.v.v..>v>>.>vv..v...v>.v.>vvv..vvv..>vv.v.>.>>..>.>v..v.>..........>vv>.v.vvv...v..vv.v>v>.v>...>vv>>>..>.v>>.>...vv...>vv>>v
.>>>v>>.>>...v.>vv...>v.vv..v.vvv.>........>vvv>>..>..v.>.v....>v.v..>vv....v.>>.>>.>..>.>v>..>>.>vv>.>>v.>>..v>.vv....v...v........>v.v>v>
v..>vv>>.>>.>>.>.v.>>.vv>.>...>.v.v..>....>v.vv.v>.v...>.v>v.>.v.v.v..>v.vv...v>v..>>>>>....v.v>.vv.vvv>v..vv.v..>..v...v.>>v>>.>...v>v>.>.
.>.v.v...>...>v.>.v.....>...v>>........>v>..>v...>>..>.....>.v.vv>>>v>>.vv..>v.>..v....v>..>v...>v>v>.>.>.....vv>v.v>..v>>>..>v..>.>.>>>v.v
.....v.v>...v.v>v>.>.>.>>v.>v>>..>v.v.>.>....>>>v>>...>v.v..v.v>>>......>v..v..>.>v.vvv.>.....v...>>..>...>v.....v...>v..v>....vv..>.>.>.v.
..>..vv>>>..v.>>.v.v>>v..v>....v..>.>.>vvvv...>..v>.>>.>v.v>.>vv>v..>.>..v>...>..>v>v..v...>v...>..>v...>v..>..>...v>vvv........>.>.v.>v.vv
>.v...v>>.vv>>.v.>>.vv.>vv.vv..>v.>.>.>v.>.>.>>>>...>......v.>>.v.>>.>.v..>.......v.>.>vvv...v>.v...>v.v.v..vv>..>.>......>>..v...v.>v>..>>
.>.>.vv>...vv>.v>.v.>>..vv...v.>v.>....>vvv....v.v>>.v.vv.v>....>>v>..>...........>>..v...>.vv.v.v.v>....v.....vv..v........v.>....>.>v.v.>
.>v>>...>>>....>.v.v.vv.>.>>....v.>.>.>..>....v.>>.v>.>..v>.v>...>.>v..vv.>v..>>>v.v>>>vv>v.v..v>.....>>>..v..vv.v.>.....>.vv.vv>.vv...>>>v
.>.....>v........v.....>...>.v.>>>.>.....vv>...>.>.v.>.>.v>v>.vvv..>>..vv>>.v..>.>>.v>.>.>..>..vv...>>>.>>>.v>v>..>>>.v..v>.v......>.vvv>>.
v..vvv>>vvv.v..>>......>>...vv.v.>.v..vvv.>.vv>.>...v>>v...v...v.v.>...v.>...v.....>>>..>>.vv..v.>....v.v.v.v>v...v..>>.>v.>>>>v>>.>.v...v.
>v..v...v>>v...>>vv..>.v.>v.>.>.....v.>..v..v.>...v>>v.>v>..>v...>.>>..v>...>>.vv>..vv.>...>..v....v..>.vv>v>vv..v>.>..vv>>..>.>v>>v..>....
.v>>>.v.....>..>.....vv.vv>..>.>>..>vv.>v.....vvv>.v>.v.v..vv>...v.>...>v..>v........>...v..>v.>..v.v..v...v>v>v>>.v..>v.>.vvv>>....v.vv.v.
.>.v.v.>.v>v.>v..v.>...>.>.>..vv>.>v.v..>.v>.v..v>v.>...>>v.v>vv>.vvv..v.>v.>>...v..vv..v.v.vv.v.v.>v>.v...v.>>v..v...>>>vv..vv..v.v>.v.vv.
>.....v>>v.v>>.v.....>>>vv.v>v>>.>>v.v.>>.>>..vv.v...v>..>..vv..>>>v.>....v.>v.>vvv>>vv..v>.vv.v.>v....v>...>......v>v>.v..v..vv>vv>>.vvv>.
..>.>v>..vv>.>....>>.v.>>...>.v.>vv.v>........>>..vv..v.vv.>v>.....>..v..>..>>.vv.v>..>....v.vv.>...>>>.v...>.>..>.vv>v.>>vvv..v>>>.vv>vv..
v..>>..>v.>v>v>>>>..>...v>>>>..>v>>...v....v..v.>..v>.v..vv......vv.>.>.vvv..>v..vvv..v>>..>.v.v..>>.v>>vvv>v>.vv..>......>vv.>.v.>>...vv.v
..v.v..>..v.>.v..>.>.>.....>...v.>>.vv.>..vv>.....vvv.v.v>>.v>v.vv.v.v.>v..>....>.....v.v>>.>v.v>>.>.>>>.>v>..v>v..>...v..vv..v>v.>.>v>...v
..>..>>v>>v.>.>.....v.v..>>.vv>>vvv.vv>v>>.>v.>.v...vv..v.>.v...vvvv..vvvv>v.v..>.....>...v>v.>v..>>..vv..v....>.v>...>..>v..vv.v.v..v.v...
..>..v...vv.v.v.>..v.>>v...v...>>v>..v>..>>.v..v.vv......>v>..>>.v..>>>v...>v.v>.>>v>>....>v>.>>.>>v>..>>.vv.vv>>...v.>.v>.>>>v..>vvv>v.v.>
.>v.>.>.vv.v..v>..v..>.v.v>.v.>>..>...>.v..v>.v..>>>vv.v.>.....>....v..>.v>v..>..>>.>.v>vv...>v.v...>.vv...v>...v>vv.v>>..>.>.>.vv...>>>v>>
..vvv>.>v>>..vv>vv...v.v.>>.v..>v.v.>>.>.v>>...vvv>vv>..vv>..>....v.>..v....>>.v...v.>..v>>..>>.v..v>..>>v>..vv.v>...vv..>.vv.v>>>....>vvvv
v>>.>>.v>>.>.v..v>..v>v>...>.v..>>...v>.>..>.>..vvv.>v.>........>.>>..>>>>>..>>v..>..v..>.v.>.v.>>v.v...........>.>v.vv.>>.v...v>v>>.v.v.>v
v..v.>>>v.>vv.>>v.....>>.>.v.v..v>.>>....v>v>v>..>v.v>v.>..v>..v.>>>.v>vv.>..>v>>......vv.v.>>.vv..v.>....>>>..>.v.>.vv...>v.vv.>.>...v...v
..v>..>.v>>..v.>..>>.>...v>>v......vv.vvv.>..v.v>.>..>..>>v.>v..v>v.>>..>v.>...>>v.>...>....v...v>vv..v.v>.>.>.>v..>>v.>>.>.v>.vvv.>v.>.v..
..v.vvv>........>>vv.>.v>.v.>..v>>v>...v.vv>>v>>>.vv>v..>......vv.....v.v....>...v.......v..v..>v>v.v....>..>v.>v.v...>vvvv.v>.v>>v.>..v..>
...>.vv>..vvv>v..v....>>......>v>v..v..v..v.vvvv>vv..v.>...vv>...v>...>v......>v>>v.....vv.>....v>>>......>.v..>.v....>vvvv...>..v>>v...v..
.>v>>v.....v..>v.vvv>>>v.v>...>..>....>..>v..v..v.>>..v..>...>..vv..>....vv>v>v>...v...v>.v>>.....>.>.>.>..v.....>..>v..v.....v..v>..v.....
...v....vv>>..v>>.v.v>.>..v...v>..v.......>v>vvv.vv.v>.>>>v.>..v.v..>.vv>.v...vv.>.v.v..>..v.>vv.v>>..>.>...>.v>.v.v......>v>>v>.>>>...v>.v
>>v.v.v.>.>.v.>vv..v...>.>...>....vv>..v.>>v.>....vv.>>....vv..v.........v....v.v...>...>v>..v.>.vv>>.>>>..>v>....>..>>...v.v..>.vv....>.v.
v>.>.v.>v...v....>v>>>>.v..>.v>.>v..>vvv.v>v>..>>vv......>>.v...>.v...v.v...>vvv..>>>vv.vv..>v>vvvvvvvv...>...v>v..vv..v..v>.vv>..v>.>>..>.
>....vv.v.v...v>..v...v.>>>>.v>.v>.>>..>v.v>.v>v....v...>>.>..>>>v...v>.>.....>>..v..vv.vv.v..v.v>....>vvvv.>vv.vv...v.>.>>.v..vv>v..vv>.v.
..v.vv.>..v>...vvv>vv.v...v>..vvv>.vvv.>.>v>.v>>.>...v>.........v.v......v.>>..>...v.v...v...>.vv.v.>vvv>v.>vv>..v..>vv...v..v.v...>.vvvvvv
..>>v...>...........>>v>>...vv>v.>v........>..v>...vv....v>..v..v>>vv...>..>>...vvvv.>.>>>.>vv...>v.v.>>.......>..vv>.>vv.v.vvv..>vv>>.v.>.
.>vv>.>>>..vv.v..>.>v....v.>..v>.v.vv.vv...v..>.vv...>v>.>...vv....v>>>v..>....>....vv.>.>..>..>.>v.vv..v...>.v...v.v>.>>.......>..>v......
..vv.>....>.>v.>..>.>>>.v..vv..vvv>..vv.v>...v.v>..>..vv>.v.v.v...vv.>....vv...>.>....v.v.>>.>>..v..>>..>..>>v.v>vv>.v..v.v.>..>..>>.v.v>vv
.>..vvv>v.>.v>>v>v>.v..>..>v..vv>>>>.>>...v>..v>>>v..>>>v>>.v.>>.>>.>.>>v....v>...v>.v>v>vvv.>.>v.....v>.>v.v...>...v.v...v.v...>.....v>v..
..>v.>...>>.>>.v>..>v.>..v>..>...v.>..>.>..v......>v.v.v>..>>>v.v.v..>.>v>......vv..>.....vvv.>.v>.vv...v...>.v.v.>..>.>>.....>>>>...v>....
>.v>vvv>....>..v>..v.>..>vv>v..>...>>>>....v..v...>v.v>..>>..>.....>>.....>..vv>>.>>......>.>.vvvvvvv..>v.>>>v>....v>.v>v.v.v.vv...>>....>.
vv>>.v>..>vv..>.v.>.>.vv.v..vv.>>..>.....vv.>.v..vv>v>vv...vvv>....v>.v>v...>vv.v.vv...>.vv>.v.vv>....>..>>v..>v.>.v.v..v>v..>.vvvv..v..v>>
..v>v>>....vv....v>..>.>v.v...>v.>.>>.>>>.v..>.v>v>......v>.....v..>.>vvv>.>..>.v...vv>>v.>vv>v..v.>.>v..v.>.>>>.>.v.v.>.v>vvv.>.>v....v...
>v..v.>v....vv>v...>.v....v>>..>..v..>>...>....v..>..>vv>v..>v..>v.v.>v......>.v.>..vv>>v..v.v>>.>v>v.....v.v.vv>..>>..>>.v.v.v>..>>>.v>.v.
.>.v..v..>>.....v>..>.>>.vv..v>>..vv>..>v.vv>>>v.>.vv....v...v.>.vv...v>...>v>..vvvv>v...>>v>>>.>v>v..>vv....v.>>v.>>.>...>v>>>>v....>.>.v.
>...vv..v.>>.>.vv>...vv..>>vv..>..>>>.....vv>..v.>>.>..>.>....>v.>..>...vv....v.vvv.>.>vv..v....>v>>.v.v>..>>...>>....>..v.>..v>>>.vv>>..v>";

    private const string testinput = @"v...>>.vv>
.vv>>.vv..
>>.>v>...v
>>v>>.>.v.
v>v.vv.v..
>.>>..v...
.vv..>.>v.
v.v..>>v.v
....v..v.>";
    public override Task ExecuteAsync()
    {
        var split = input.Split(Environment.NewLine);
        int maxX = split[0].Length;
        int maxY = split.Length;
        char[,] grid = new char[maxX, maxY];
        int y = 0;
        foreach (var line in split)
        {
            int x = 0;
            foreach (var c in line)
            {
                grid[x, y] = c;
                x++;
            }

            y++;
        }

        int count = 1;
        while (Step())
        {
            count++;
        }

        Result = count.ToString();

        void Print(char[,] currentGrid)
        {
            return;
            for (int y = 0; y < maxY; y++)
            {
                for (int x = 0; x < maxX; x++)
                {
                    Console.Write(currentGrid[x, y]);
                }
                Console.WriteLine();
            }

            Console.WriteLine();
        }

        bool Step()
        {
            var newGrid = new char[maxX, maxY];
            bool moved = false;
            for (int y = 0; y < maxY; y++)
            {
                for (int x = 0; x < maxX; x++)
                {
                    var east = (x + 1) % maxX;
                    var val = grid[x, y];
                    if (val == '>' && grid[east, y] == '.')
                    {
                        newGrid[x, y] = '.';
                        newGrid[east, y] = '>';
                        x++;
                        moved = true;
                    }
                    else
                    {
                        newGrid[x, y] = val;
                    }
                }
            }
            Print(newGrid);

            for (int x = 0; x < maxX; x++)
            {
                for (int y = 0; y < maxY; y++)
                {
                    var south = (y + 1) % maxY;
                    var val = newGrid[x, y];
                    if (val == 'v' && newGrid[x, south] == '.')
                    {
                        grid[x, y] = '.';
                        grid[x, south] = 'v';
                        moved = true;
                        y++;
                    }
                    else
                    {
                        grid[x, y] = val;
                    }
                }
            }

            Print(grid);

            return moved;
        }


        return Task.CompletedTask;
    }

    public override int Nummer => 202125;
}